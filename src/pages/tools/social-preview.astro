---
import ToolLayout from "@/layouts/ToolLayout.astro";
import SocialPreviewTool from "@/components/vue/tools/SocialPreviewTool.vue";

var toolKeywords =
  "social preview generator, og image generator, open graph image maker, twitter card generator, social media image creator, free og image tool, meta image generator, link preview image, social share image, facebook og image";

var structuredData = {
  "@context": "https://schema.org",
  "@type": "WebApplication",
  name: "Social Preview Generator",
  description:
    "Generate beautiful Open Graph images for your tools, blog posts, and pages. Three professional variants to choose from. Free, no signup required.",
  url: "https://meysam.io/tools/social-preview",
  applicationCategory: "DeveloperApplication",
  operatingSystem: "Any",
  offers: {
    "@type": "Offer",
    price: "0",
    priceCurrency: "USD",
  },
  featureList: [
    "Three professional design variants",
    "Real-time preview",
    "1200x630 PNG export",
    "No signup required",
    "Free to use",
  ],
  author: {
    "@type": "Person",
    name: "Meysam Azad",
    url: "https://meysam.io",
  },
};
---

<ToolLayout
  title="Social Preview Generator"
  description="Generate beautiful Open Graph images for your tools, blog posts, and pages. Three professional design variants. 1200x630 PNG export. Free, no signup."
  ogImage="https://meysam.io/og/social-preview.png"
  canonicalPath="/tools/social-preview"
  structuredData={structuredData}
  keywords={toolKeywords}
>
  <!-- Tool Header -->
  <div class="tool-header">
    <h1>Social Preview Generator</h1>
    <p class="subtitle">
      Create beautiful Open Graph images (og-image) for your pages. Three
      variants, instant download.
    </p>
  </div>

  <div class="tool-content">
    <!-- Main Tool with Vue Island -->
    <SocialPreviewTool client:only="vue" />

    <!-- Newsletter CTA -->
    <div class="tool-card newsletter-section">
      <h2>Want More Free Tools?</h2>
      <p>
        Get notified when new developer tools drop. Weekly tips from 8+ years
        building production systems.
      </p>

      <form
        class="newsletter-form listmonk-form"
        data-pirsch-event="subscribe"
        data-pirsch-meta-page_url="/tools/social-preview"
        data-pirsch-meta-variant="social-preview-tool"
        data-pirsch-non-interactive
        action="https://newsletter.meysam.io/subscription/form"
        method="post"
      >
        <input type="hidden" name="nonce" />
        <input
          id="00a2c"
          type="hidden"
          name="l"
          value="00a2c2b8-467a-4d74-9c76-9c6472c91d06"
        />
        <input
          type="text"
          name="name"
          value=""
          class="honeypot-field"
          tabindex="-1"
          autocomplete="off"
          aria-hidden="true"
        />
        <input
          type="text"
          name="company"
          value=""
          class="honeypot-field"
          tabindex="-1"
          autocomplete="off"
          aria-hidden="true"
        />
        <input
          type="text"
          name="website"
          value=""
          class="honeypot-field"
          tabindex="-1"
          autocomplete="off"
          aria-hidden="true"
        />
        <div class="form-row">
          <input
            type="email"
            name="email"
            placeholder="your@email.com"
            required
            aria-label="Email address"
            class="email-input"
          />
          <altcha-widget
            class="altcha-widget"
            challengeurl="https://newsletter.meysam.io/api/public/captcha/altcha"
            auto="onfocus"></altcha-widget>
          <button type="submit" class="btn btn-primary">Get Early Access</button
          >
        </div>
        <p class="form-note">Join 1,500+ engineers. No spam.</p>
      </form>

      <div class="success-message hidden" id="newsletter-success">
        <svg
          width="48"
          height="48"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
          <polyline points="22 4 12 14.01 9 11.01"></polyline>
        </svg>
        <h3>Check Your Email!</h3>
        <p>Click the confirmation link to complete your subscription.</p>
      </div>
    </div>
  </div>
</ToolLayout>

<script>
  import log from "loglevel";

  function initNewsletterForm() {
    var form = document.querySelector(
      ".newsletter-form",
    ) as HTMLFormElement | null;
    var successMessage = document.getElementById("newsletter-success");

    if (!form || !successMessage) {
      return;
    }

    form.addEventListener("submit", function handleSubmit(e) {
      e.preventDefault();
      var formData = new FormData(form);

      var honeypotFields = form.querySelectorAll(
        ".honeypot-field",
      ) as NodeListOf<HTMLInputElement>;
      var isBot = false;
      honeypotFields.forEach(function checkField(field) {
        if (field.value !== "") {
          isBot = true;
        }
      });

      if (isBot) {
        return;
      }

      fetch(form.action, {
        method: "POST",
        body: formData,
      })
        .then(function handleResponse(response) {
          if (response.ok) {
            form.classList.add("hidden");
            successMessage.classList.remove("hidden");
          }
        })
        .catch(function handleError(err) {
          log.error("Newsletter error:", err);
        });
    });
  }

  document.addEventListener("DOMContentLoaded", initNewsletterForm);
  document.addEventListener("astro:page-load", initNewsletterForm);
</script>

<style>
  /* Newsletter Section */
  .newsletter-section {
    text-align: center;
    margin-top: var(--space-xl);
  }

  .newsletter-section h2 {
    font-size: 1.5rem;
    margin-bottom: var(--space-sm);
  }

  .newsletter-section > p {
    color: var(--color-text-muted);
    margin-bottom: var(--space-lg);
  }

  .form-row {
    display: flex;
    gap: var(--space-sm);
    max-width: 500px;
    margin: 0 auto var(--space-sm);
  }

  .email-input {
    flex: 1;
  }

  .altcha-widget {
    display: none;
  }

  .form-note {
    font-size: 0.875rem;
    color: var(--color-text-dim);
    margin: 0;
  }

  .honeypot-field {
    position: absolute;
    left: -9999px;
    width: 1px;
    height: 1px;
    opacity: 0;
  }

  .success-message {
    padding: var(--space-xl);
    color: var(--color-success);
  }

  .success-message h3 {
    margin: var(--space-md) 0 var(--space-sm);
    font-size: 1.25rem;
  }

  .success-message p {
    color: var(--color-text-muted);
    margin: 0;
  }

  /* Responsive */
  @media (max-width: 768px) {
    .form-row {
      flex-direction: column;
    }
  }

  .hidden {
    display: none !important;
  }
</style>

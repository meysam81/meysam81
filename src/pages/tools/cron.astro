---
import ToolLayout from "@/layouts/ToolLayout.astro";
import CronTool from "@/components/vue/tools/CronTool.vue";
import FAQAccordion from "@/components/FAQAccordion.astro";
import ToolNewsletterCTA from "@/components/ToolNewsletterCTA.astro";
import { getPresets, getExamplePhrases } from "@/utils/cron";
import {
  getToolBySlugOrThrow,
  generateToolStructuredData,
  generateFAQStructuredData,
} from "@/data/tools";

var tool = getToolBySlugOrThrow("cron");
var presets = getPresets();
var examplePhrases = getExamplePhrases();

var structuredData = generateToolStructuredData(tool);
var faqData = generateFAQStructuredData(tool.faqs);
---

<ToolLayout
  title={tool.title}
  description={tool.description}
  ogImage={tool.ogImage}
  canonicalPath={"/tools/" + tool.slug}
  structuredData={structuredData}
  keywords={tool.keywords}
>
  {
    faqData && (
      <Fragment slot="head">
        <script type="application/ld+json" set:html={JSON.stringify(faqData)} />
      </Fragment>
    )
  }

  <!-- Tool Header -->
  <div class="tool-header">
    <h1>{tool.title}</h1>
    <p class="subtitle">
      Build and decode cron schedules with plain English. No signup, no ads.
    </p>
  </div>

  <div class="tool-content">
    <!-- Main Tool Card with Vue Island -->
    <div class="tool-card">
      <CronTool
        client:only="vue"
        presets={presets}
        examplePhrases={examplePhrases}
      />
    </div>

    <!-- Reference Section (Static) -->
    <div class="tool-card reference-section">
      <h2>Cron Syntax Reference</h2>

      <div class="reference-grid">
        <div class="reference-item">
          <h3>Fields</h3>
          <table class="reference-table">
            <thead>
              <tr>
                <th>Field</th>
                <th>Values</th>
              </tr>
            </thead>
            <tbody>
              <tr><td>Minute</td><td>0-59</td></tr>
              <tr><td>Hour</td><td>0-23</td></tr>
              <tr><td>Day of Month</td><td>1-31</td></tr>
              <tr><td>Month</td><td>1-12</td></tr>
              <tr><td>Day of Week</td><td>0-7 (0 & 7 = Sun)</td></tr>
            </tbody>
          </table>
        </div>

        <div class="reference-item">
          <h3>Special Characters</h3>
          <table class="reference-table">
            <thead>
              <tr>
                <th>Char</th>
                <th>Meaning</th>
              </tr>
            </thead>
            <tbody>
              <tr><td><code>*</code></td><td>Every value</td></tr>
              <tr><td><code>,</code></td><td>List (1,3,5)</td></tr>
              <tr><td><code>-</code></td><td>Range (1-5)</td></tr>
              <tr><td><code>/</code></td><td>Step (*/15)</td></tr>
              <tr><td><code>L</code></td><td>Last day</td></tr>
              <tr><td><code>#</code></td><td>Nth weekday (1#2)</td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- FAQ Section -->
    <div class="tool-card">
      <FAQAccordion faqs={tool.faqs} />
    </div>

    <!-- Newsletter CTA -->
    <div class="tool-card">
      <ToolNewsletterCTA
        pageUrl="/tools/cron"
        variant="cron-tool"
        title="Like This Tool?"
        description="Get weekly DevOps tips and production insights from 8+ years in the trenches."
      />
    </div>
  </div>
</ToolLayout>

<style>
  @import "@/styles/tools.css";
</style>
